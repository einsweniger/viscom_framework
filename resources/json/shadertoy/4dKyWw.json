{
  "Shader": {
    "ver": "0.1",
    "info": {
      "id": "4dKyWw",
      "date": "1522247929",
      "viewed": 153,
      "name": "Cartoon Sphere & heart",
      "username": "tyw66",
      "description": "\u7403\u4f53/\u5fc3\u5f62\uff0c\u6309\u7167\u6f2b\u53cd\u5c04/\u5361\u901a\u98ce\u683c\u6e32\u67d3,\u3002\nSphere/heart model with cartoon/wap _diffused style.\n\n\u4ea4\u4e92\uff1a\u8bf7\u5728\u89c6\u56fe\u533a\u62d6\u62fd\u9f20\u6807\uff0c\u4ee5\u6539\u53d8\u5149\u6e90\u65b9\u5411\n To chage light direction, please press and drag mouse in the viewport.\n",
      "likes": 2,
      "published": 3,
      "flags": 0,
      "tags": [
        "cartoon",
        "sphere",
        "heart"
      ],
      "hasliked": 0
    },
    "renderpass": [
      {
        "inputs": [],
        "outputs": [
          {
            "id": 37,
            "channel": 0
          }
        ],
        "code": "//some control\nbool IsCartoon = true;\nint shape = 1;\n////////////////////////////////////////////\n\nfloat f(float x,float y,float z){\n    if(shape==0){\n        return x*x+y*y+z*z-1.0f;\n    }\n    else if(shape==1){\n        float a = x*x + 9.0f/4.0f *y*y+z*z-1.0f;\n        return a*a*a-x*x*z*z*z-9.0f/80.0f*y*y*z*z*z;\n    }\n}\n\nfloat h(float x,float z){\n    for(float y =-1.0f; y< 0.0f;  y+=0.01f){\n        if(f(x,y,z)<0.0f)\n            return y;\n    }\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    // Normalized pixel coordinates (from 0 to 1)\n    vec2 uv = fragCoord/iResolution.xy;\n    vec2 cur = iMouse.xy/iResolution.xy *4.0f-2.0f;\n    \n    \n    ////  some vector   ////\n    float x = (uv[0] *3.0f - 1.5f)*1.6f;\n    float z = uv[1] *3.0f - 1.5f ;\n    if(f(x,0.0f,z)<0.0f){\n        float y = h(x,z);\n        vec3 Coord = vec3(x, y, z);\t//\u5750\u6807Coord\n        vec3 L = vec3(cur[0], -1.0f, cur[1]);\t//\u5149\u7ebf\u5411\u91cfLight vector\n        vec3 N = vec3(x, y, z);\t\t//\u6cd5\u5411\u91cfNormal vector\t\n        float normN = sqrt(x*x+y*y+z*z);\n        //// \u5149\u7167\u6a21\u578blighting model  //// \n        float cosNL = dot(L,N)/normN/sqrt(3.0f);\n\n        //\u6f2b\u53cd\u5c04\u90e8\u5206 \n        float diffuse = cosNL;\n        diffuse = cosNL*0.5f+0.5f;//wrapped diffuse\u5904\u7406 \n\n        //\u9ad8\u5149\u90e8\u5206 \n        float specular = cosNL;\n        specular = pow(cosNL,64.0f); //phong \n       \n\n        //\u63cf\u8fb9\u90e8\u5206 \n        float cosNY = -y /normN/ sqrt(3.0f);\n        float pCosNY = pow(cosNY,64.0);\n        bool rim = false;\n        if(cosNY<0.1f && cosNY>0.0f)rim = true;\n        \n        \n        //// \u50cf\u7d20\u7740\u8272pixel coloring ////         \n        vec3 color; \n        if(rim){\n            color = vec3(0.0, 0.0, 0.0);//\u63cf\u8fb9\u8272\n        }\n        else{\n            vec3 Cr = vec3( 1.0, 0.0, 0.0 ); \n            float a = 0.05f; \t\t\t//\u73af\u5883\u5149\u8865\u507f \n            float p = 1.00f;\t\t\t//\u5149\u5f3a\u5ea6\u7cfb\u6570 \n            vec3 Cp = vec3( 1.0f,1.0f,1.0f ); \t//\u9ad8\u5149\u989c\u8272 \n\n            //\u5361\u901a\u6e32\u67d3\u6548\u679c\uff0c\u6839\u636e\u4e0d\u540c\u533a\u95f4\uff0c\u7ed9diffuse\u4e0d\u540c\u503c\n            if(IsCartoon){\n                //\u5361\u901a\u6f2b\u53cd\u5c04 \n                if(cosNL>0.8f){diffuse = 0.9f*0.5f+0.5f;}\n                else if(cosNL>0.6f){diffuse = 0.7f*0.5f+0.5f;}\n                else if(cosNL>0.35f){diffuse = 0.45f*0.5f+0.5f;}\n                else if(cosNL>0.10f){diffuse = 0.22f*0.5f+0.5f;}\n                else {diffuse = 0.1f*0.5f+0.5f;}\n\n                //\u5361\u901a\u9ad8\u5149 \n                if(cosNL>0.995f){specular = 1.0f;} \n                else if(cosNL>0.99f){specular = 0.95f;} \n                else{specular = 0.0f;}\n            } \n            // reference\u53c2\u8003\u7684\u516c\u5f0f\uff1aC = Cr(Ca+Cl*max(0,N\u00b7L))+ClCp*(N\u00b7H)^p \n            color =  Cr*(a+p*diffuse)+Cp*p*specular;\t\n        }              \n        fragColor = vec4(color,1.0);\n    }\n    //\u50cf\u7d20\u70b9\u4e0d\u5c5e\u4e8e\u51e0\u4f55\u4f53\n    else\n        fragColor = vec4(1.0,0.8,0.4,1.0);\n    }\n",
        "name": "Image",
        "description": "",
        "type": "image"
      }
    ]
  }
}