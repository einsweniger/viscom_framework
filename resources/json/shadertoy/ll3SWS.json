{
  "Shader": {
    "ver": "0.1",
    "info": {
      "id": "ll3SWS",
      "date": "1481360634",
      "viewed": 412,
      "name": "Kaleidoscopic Feedback Fractals",
      "username": "ttg",
      "description": "Kaleidoscopic folding combined with texture feedback.\n\nClick on screen and move around slowly to manipulate angle and scaling.",
      "likes": 10,
      "published": 3,
      "flags": 32,
      "tags": [
        "fractal",
        "feedback",
        "multipass"
      ],
      "hasliked": 0
    },
    "renderpass": [
      {
        "inputs": [
          {
            "id": 257,
            "src": "/media/previz/buffer00.png",
            "ctype": "buffer",
            "channel": 0,
            "sampler": {
              "filter": "linear",
              "wrap": "clamp",
              "vflip": "true",
              "srgb": "false",
              "internal": "byte"
            },
            "published": 1
          }
        ],
        "outputs": [
          {
            "id": 37,
            "channel": 0
          }
        ],
        "code": "/*\n\nKaleidoscopic Feedback Fractals\nCopyright 2016 Theron Tarigo\n\nKaleidoscopic folding combined with texture feedback.\n\nClick on screen and move around slowly to manipulate angle and scaling.\n\n*/\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    float zoom = 1.;\n\tvec2 uv = fragCoord.xy / iResolution.xy;\n    fragColor.a = 1.0;\n\tfragColor.rgb = vec3(2.,1.,3.)*texture(iChannel0, (uv-vec2(0.5))*zoom+vec2(0.5)).rgb;\n}\n",
        "name": "Image",
        "description": "",
        "type": "image"
      },
      {
        "inputs": [
          {
            "id": 28,
            "src": "/media/a/85a6d68622b36995ccb98a89bbb119edf167c914660e4450d313de049320005c.png",
            "ctype": "texture",
            "channel": 1,
            "sampler": {
              "filter": "nearest",
              "wrap": "repeat",
              "vflip": "true",
              "srgb": "false",
              "internal": "byte"
            },
            "published": 1
          },
          {
            "id": 257,
            "src": "/media/previz/buffer00.png",
            "ctype": "buffer",
            "channel": 0,
            "sampler": {
              "filter": "linear",
              "wrap": "clamp",
              "vflip": "true",
              "srgb": "false",
              "internal": "byte"
            },
            "published": 1
          }
        ],
        "outputs": [
          {
            "id": 257,
            "channel": 0
          }
        ],
        "code": "/*\n\nKaleidoscopic Feedback Fractals\nCopyright 2016 Theron Tarigo\n\nKaleidoscopic folding combined with texture feedback.\n\nClick on screen and move around slowly to manipulate angle and scaling.\n\n*/\n\n#define pi 3.14159\n\nvec2 kld(vec2 v, vec2 v1) {\n    \n    float a = 2.*pi/3.;\n    mat2 t = mat2(cos(a),-sin(a),sin(a),cos(a));\n    vec2 v2 = t*v1;\n\n    vec2 o = vec2(1.,1.)*2./3.;\n    float mult = 1.0;\n    v1 = mult*v1;\n    v2 = mult*v2;\n    \n    vec2 x;\n    {\n        float r1 = mod(dot(v, v1)/dot(v1, v1)+o.x,3.);\n        float r2 = mod(dot(v, v2)/dot(v2, v2)+o.y,3.);\n\n        float s1 = 3.-abs(3.-(r1+r2));\n        float s2 = r1-r2;\n\n        r1 = 0.5*(s1+s2);\n        r2 = 0.5*(s1-s2);\n\n        vec3 c;\n        c.x = -(r1+r2)+2.;\n        c.y = r1-1.;\n        c.z = -c.x-c.y;\n\n        vec3 d = c;\n        if (c.x>1.) { d+=vec3(-2.,1.,1.); }\n        if (c.y>1.) { d+=vec3(1.,-2.,1.); }\n        if (c.z>1.) { d+=vec3(1.,1.,-2.); }\n        c = d;\n\n        x.x = 1.-max(max(abs(c.x),abs(c.y)),abs(c.z));\n    }\n    \n    {\n        float r1 = mod(dot(v, v1)/dot(v1, v1)+o.x,3.);\n        float r2 = mod(dot(v, v2)/dot(v2, v2)+1.+o.y,3.);\n\n        float s1 = 3.-abs(3.-(r1+r2));\n        float s2 = r1-r2;\n\n        vec3 c;\n        c.x = 0.5*(s1-s2)-1.;\n        c.y = 0.5*(s1+s2)-1.;\n        c.z = -c.x-c.y;\n\n        vec3 d = c;\n        if (c.x>1.) { d+=vec3(-2.,1.,1.); }\n        if (c.y>1.) { d+=vec3(1.,-2.,1.); }\n        if (c.z>1.) { d+=vec3(1.,1.,-2.); }\n        c = d;\n\n        x.y = 1.-max(max(abs(c.x),abs(c.y)),abs(c.z));\n    }\n\n    float mult2 = sqrt(3.)/3.;\n    vec2 v1r = vec2(-v1.y,v1.x)*mult2;\n    vec2 v2r = vec2(-v2.y,v2.x)*mult2;\n    return ( (x.x-1./3.)*(v2r)+(x.y-1./3.)*(v1r+v2r) )*2.;\n}\n\nvec3 read(vec2 uv) {\n    return vec3(0.);\n}\n\nvoid mainImage( out vec4 fragColor, in vec2 fragCoord )\n{\n    fragColor = vec4(0.0,0.0,0.0,1.0);\n    vec2 uv = ( fragCoord.xy - 0.5*iResolution.xy ) / iResolution.yy;\n    vec2 m = ( iMouse.xy - 0.5*iResolution.xy ) / iResolution.yy;\n    float a = iTime*0.02;\n    if ( length(iMouse.xy)<2. ) { m = vec2(cos(a),sin(a))*0.28; }\n    vec3 uvh = vec3(uv,1.);\n    \n    float th1 = 0.1;\n    mat3 trans1 = 2.0*mat3(\n        cos(th1),sin(th1),0.,\n        -sin(th1),cos(th1),0.,\n        0.05, 0.02, 1.);\n    \n    float th2 = -0.53;\n    mat3 trans2 = 5.5*mat3(\n        cos(th2),-sin(th2),0.,\n        sin(th2),cos(th2),0.,\n        0., 0., 1.);\n    \n    mat3 clrtrans1 = 0.9*mat3(\n        1., -0.1, 0.1,\n        -0.1, 1.0, -0.1,\n        -0.1, 0.1, 1.0 );\n\n    float th4 = 1.*pi/2.;\n    \n    vec2 uvk = kld(uv,vec2(1.,0.));\n    mat2 mrot = 5.*mat2(m.x,-m.y,m.y,m.x);\n    vec2 uvk2 = kld(mrot*uvk+vec2(0.),vec2(0.7,0.0));\n    fragColor.rgb = clrtrans1*texture(iChannel0, uvk2*vec2(iResolution.y/iResolution.x,1.)+vec2(0.5)).rgb;\n    fragColor.rgb += 0.5*vec3(pow(max(0.,1.-abs(0.28+dot(vec2(cos(th4),sin(th4)),uvk))),50.));\n}\n",
        "name": "Buf A",
        "description": "",
        "type": "buffer"
      }
    ]
  }
}